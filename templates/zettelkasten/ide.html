{% extends "base.html" %}
{% load static %}

{% block title %}Zettelkasten{% endblock %}

{% block content %}

<div class="ide-container">
    <div class="file-manager-container" >
        {% include "zettelkasten/file_manager/_file_manager_bar.html" %}
        {% include "zettelkasten/file_manager/file_manager.html" %}
    </div>
    <div class="resizer" id="resizer"></div>

    <div class="editor-container">
        {% include "zettelkasten/editor/_editor_bar.html" %}
        {% include "zettelkasten/editor/editor.html" %}
    </div>

</div>

{% endblock %}

{% block extra_js %}
<!-- Core Dependencies -->
<script type="module" src="{% static 'js/02-core/dom.js' %}"></script>
<script src="{% static 'js/02-core/api.js' %}"></script>

<!-- IDE System Components -->
<script src="{% static 'js/03-components/ide/FileManager.js' %}"></script>
<script src="{% static 'js/03-components/ide/Resizer.js' %}"></script>
<script src="{% static 'js/03-components/ide/IDEController.js' %}"></script>

<!-- External Dependencies -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/turndown/dist/turndown.min.js"></script>

<!-- Initialize IDE -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Wait for CodeMirror editor to be initialized
    function waitForEditor() {
        if (window.cmEditor) {
            // Editor is ready, initialize IDE
            window.ideController = new IDEController();
        } else {
            // Editor not ready yet, wait a bit longer
            console.log('Waiting for CodeMirror editor...');
            setTimeout(waitForEditor, 100);
        }
    }
    
    // Start waiting for editor
    waitForEditor();
});
</script>
{% endblock %}

